service cloud.firestore {
  match /databases/{database}/documents {

	match /Notifications/{notification} {
		allow read: if request.auth.uid != null && exists(/databases/$(database)/documents/Clearance/$(request.auth.uid));
		allow write: if request.auth.uid != null && exists(/databases/$(database)/documents/Clearance/$(request.auth.uid));
		allow delete: if false;
	}

	match /SS/{user} {
		allow read: if true;
		allow write: if true;
		allow delete: if false;
	}

	match /Teams/{team} {
		allow read: if request.auth.uid != null && exists(/databases/$(database)/documents/Clearance/$(request.auth.uid));
		allow write: if request.auth.uid != null && exists(/databases/$(database)/documents/Clearance/$(request.auth.uid));
		allow delete: if request.auth.uid != null && exists(/databases/$(database)/documents/Clearance/$(request.auth.uid));
	}

	match /Todo/{ftg} {
		allow read: if request.auth.uid != null && exists(/databases/$(database)/documents/Clearance/$(request.auth.uid));
		allow write: if request.auth.uid != null && exists(/databases/$(database)/documents/Clearance/$(request.auth.uid));
		allow delete: if request.auth.uid != null && exists(/databases/$(database)/documents/Clearance/$(request.auth.uid));
	}

	match /users/{user} {
		allow read: if true;
		allow write: if request.auth.uid != null;
		allow delete: if request.auth.uid != null && exists(/databases/$(database)/documents/Clearance/$(request.auth.uid));
	}

	match /Clearance/{user} {
		allow read: if request.auth.uid != null && exists(/databases/$(database)/documents/Clearance/$(request.auth.uid));
		allow create: if exists(/databases/$(database)/documents/Clearance/$(request.auth.uid));
		allow write: if exists(/databases/$(database)/documents/Clearance/$(request.auth.uid));
		allow delete: if false;
	}

  }
}
